<style>
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .product-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .product-title {
      margin-top: 0;
      color: #2a69ac;
    }
    .price {
      font-weight: bold;
      color: #e63946;
      font-size: 1.2em;
    }
    .product-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .tag {
      display: inline-block;
      background: #f0f0f0;
      padding: 3px 8px;
      border-radius: 3px;
      font-size: 0.8em;
      margin-right: 5px;
      margin-bottom: 5px;
    }
    .sale {
      background: #e63946;
      color: white;
    }
    .new {
      background: #2a9d8f;
      color: white;
    }
    .out-of-stock {
      opacity: 0.6;
    }
    .stock-status {
      margin-top: 10px;
      font-size: 0.9em;
    }
    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }
    .pagination a {
      margin: 0 5px;
      padding: 8px 12px;
      border: 1px solid #ddd;
      text-decoration: none;
      color: #333;
      border-radius: 4px;
    }
    .pagination a.active {
      background-color: #2a69ac;
      color: white;
      border-color: #2a69ac;
    }
  </style>


  {% if this.Model.Products.size > 0 %}
    <div class="product-grid">
      {% for product in this.Model.Products %}
        <div class="product-card {% if product.InStock == false %}out-of-stock{% endif %}">
          {% if product.Image %}
            <img src="{{ product.Image }}" alt="{{ product.title }}" class="product-image">
          {% endif %}
          
          <h2 class="product-title">{{ product.Title }}</h2>
          
          <div>
            {% for tag in product.Tags %}
              <span class="tag {% if tag.Tag == '促销' %}sale{% endif %} {% if tag.Tag == '新品' %}new{% endif %}">{{ tag.Tag }}</span>
            {% endfor %}
          </div>
          
          <p>{{ product.Description | truncate: 100 }}</p>
          
          <p class="price">
            {% if product.CompareAtPrice and product.CompareAtPrice > product.Price %}
              <span style="text-decoration: line-through; color: #888; font-size: 0.9em;">{{ product.CompareAtPrice }}元</span>
            {% endif %}
            {{ product.Price }}元
          </p>
          
          <div class="stock-status">
            {% if product.InStock %}
              {% if product.Inventory < 5 and product.Inventory > 0 %}
                <span style="color: orange;">库存紧张，仅剩{{ product.Inventory }}件</span>
              {% else %}
                <span style="color: green;">有货</span>
              {% endif %}
            {% else %}
              <span style="color: red;">缺货</span>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="pagination">
      {% for i in (1..this.Model.Pagination.TotalPages) %}
        <a href="?page={{ i }}" {% if this.Model.Pagination.CurrentPage == i %}class="active"{% endif %}>{{ i }}</a>
      {% endfor %}
    </div>
  {% else %}
    <p>暂无商品</p>
  {% endif %}
